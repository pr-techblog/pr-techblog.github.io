<!DOCTYPE html><html><head><title>گیت Rebase به زبان ساده</title><meta charset="utf-8" /><meta content='text/html; charset=utf-8' http-equiv='Content-Type'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'><meta property="og:locale" content="fa_IR" /><meta property="og:site_name" content="پول ریکوئست" /><meta name="twitter:image" content="/assets/images/pr.svg" /><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="theme-color" content="#000"><meta property="og:type" content="article" /><meta name="description" content="در طی سال های اخیر بعد از درک این‌که WorkFlow یا جریان کاری در سورس کنترل چقدر در کار تیمی اهمیت داره، به تمام اطرافیانم توصیه میکردم و میکنم که از فلو مناسب برای گیت استفاده کنند. ورک فلو یک قرارداده بین افراد تیم برای یکسان بودن سیاست برنچینگ. " /><meta property="og:description" content="در طی سال های اخیر بعد از درک این‌که WorkFlow یا جریان کاری در سورس کنترل چقدر در کار تیمی اهمیت داره، به تمام اطرافیانم توصیه میکردم و میکنم که از فلو مناسب برای گیت استفاده کنند. ورک فلو یک قرارداده بین افراد تیم برای یکسان بودن سیاست برنچینگ. " /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="در طی سال های اخیر بعد از درک این‌که WorkFlow یا جریان کاری در سورس کنترل چقدر در کار تیمی اهمیت داره، به تمام اطرافیانم توصیه میکردم و میکنم که از فلو مناسب برای گیت استفاده کنند. ورک فلو یک قرارداده بین افراد تیم برای یکسان بودن سیاست برنچینگ. " /><meta name="author" content="پول ریکوئست به قلم nima" /><meta property="og:title" content="گیت Rebase به زبان ساده" /><meta property="twitter:title" content="گیت Rebase به زبان ساده" /><link rel="stylesheet" type="text/css" href="/style.css" /><link rel="alternate" type="application/rss+xml" title="پول ریکوئست - پول ریکوئست، دست نوشته های فنی فارسی زبان" href="/feed.xml" /> <script src="/pr.js"></script><body><div class="site__container"><header class="site__header container"><figure class="site__header__brand"> <a href="http://pullrequest.ir"> <img src="/assets/images/pr.svg" alt="PR"> </a></figure><nav class="site__header__nav"><ul class="list--unstyled list--inline header__list text--center"><li> <a href="/about">پول ریکوئست چیست</a><li> <a href="/pr-authors">نویسندگان</a><li> <a href="/contribute">راهنمای انتشار مطالب در پول ریکوئست</a></ul></nav></header><hr class="site__header__divider container" /><main role="main" class="container"><article class="post post--single"><h1 class="post__title post__title--single">گیت Rebase به زبان ساده</h1><div class="post__info"> <span> <span class="lazyimage"> <img onload="window.pr.methods.addClass('img-loaded', this.parentNode)" onerror="window.pr.methods.addClass('img-error', this)" src="/assets/images/nima.jpeg" alt="نیما هاشمی" class="img-rounded post__info__figure inline--middle" > </span> <span class="inline--middle post__author"><a href="http://pullrequest.ir/authors/nima">نیما هاشمی</a></span> </span> <small><em>1396-1-15</em></small></div><div class="post__share text--left"><ul class="list--unstyled list--inline"><li><a class="button button--with-icon" target="_blank" href="https://twitter.com/intent/tweet?url=/%DA%AF%DB%8C%D8%AA-rebase-%D8%A8%D9%87-%D8%B2%D8%A8%D8%A7%D9%86-%D8%B3%D8%A7%D8%AF%D9%87/&via=http://pullrequest.ir&text=گیت Rebase به زبان ساده"> <i class="icon pricon-twitter"></i> توییتر </a><li><a class="button button--with-icon" target="_blank" href="https://telegram.me/share/url?url=http://pullrequest.ir/%DA%AF%DB%8C%D8%AA-rebase-%D8%A8%D9%87-%D8%B2%D8%A8%D8%A7%D9%86-%D8%B3%D8%A7%D8%AF%D9%87/"> <i class="icon pricon-telegram"></i> تلگرام </a></ul><nav class="post__tags post__tags--single"> <i class="icon pricon-tag"></i><ul class="list--unstyled list--inline"><li><a href="/tag/git">#git</a><li><a href="/tag/rebase">#rebase</a><li><a href="/tag/merge">#merge</a></ul></nav></div><div class="post__entry post__entry--single"><p>در طی سال های اخیر بعد از درک این‌که WorkFlow یا جریان کاری در سورس کنترل چقدر در کار تیمی اهمیت داره، به تمام اطرافیانم توصیه میکردم و میکنم که از فلو مناسب برای گیت استفاده کنند. ورک فلو یک قرارداده بین افراد تیم برای یکسان بودن سیاست برنچینگ.<p>برنچینگ در نهایت برای ترکیب شدن کارها به <code class="highlighter-rouge">git merge</code> یا <code class="highlighter-rouge">git rebase</code> منتهی میشه.<p>اخیرا شاهد بحثی در شبکه های اجتماعی بودم با این مضمون که خیلی از توسعه دهنده های اطرافمون به درستی از مفهوم git rebase استفاده نمی‌کنند. شاید به دلیل اینکه مفهوم اون رو درست متوجه نشدند و یا نیاز اون رو حس نکردند. حتی خودم چون در فلویی که استفاده میکنم rebase وجود نداره خیلی از این قابلیت مفید و کاربردی استفاده نمیکردم. با این حال این متن کوتاه رو نوشتم تا در حد سوادم بتونم این مفهوم رو در ساده ترین حالت تشریح کنم. برای بهتر نوشتن از این مفهوم از چند مقاله الهام گرفته شده است که بهتر و ساده تر از من این مساله رو مطرح کردند. از <a href="http://five.agency/git-merge-and-rebase-the-simple-explanation/">اینجا</a> و <a href="https://nathanleclaire.com/blog/2014/09/14/dont-be-scared-of-git-rebase/">اینجا</a> میتونین اصلشون رو ببینین<p>توجه کنید که برای خوندن این مقاله لازمه با گیت آشنا باشید و مفهوم برنچ ها رو درک کنید.<p>گیت مرج و ریبیس یک هدف مشترک دارن که ترکیب چند Branch توسعه است. اگرچه هدف نهایی مشترکه، مرج و ریبیس مسیر های مختلفی رو برای رسیدن به این هدف طی میکنن، خروجی مشابه البته با ردپایی متفاوت.<p>در ادامه از یک مخزن (repository) نمونه با دو برنچ جدا از هم <code class="highlighter-rouge">master</code> و <code class="highlighter-rouge">feature</code> استفاده خواهیم کرد و به جای هش کامیت ها از عدد برای درک بهتر استفاده میکنیم، علاوه بر اون ترتیب شماره ها ترتیب زمانی کامیت ها هم محسوب میشه به این صورت که عدد کوچکتر به معنی زودتر کامیت شدنه.<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      +--3--5   master
      |
1--2--+
      |
      +--4--6   feature
</code></pre></div></div><h2 id="git-merge">git merge</h2><p>هر مرج یک کامیت جدید است. این اصلی ترین چیزی است که باید به خاطر داشت. همزمان دلیل علاقه خیلی از توسعه دهنده ها کامیت بودن merge، دلیل نفرت خیلی از توسعه دهنده ها [ی گاها وسواسی :| ] دیگه است. در هر حال هر مرج یک کامیت است با یک تفاوت که هر کامیت مرج دو parent دارد. همه کامیت های معمول تنها یک parent دارند. چطوری بررسی کنیم؟ ترمینال رو آتیش کنین [وفاداری به متن اصلی :)) ] و <code class="highlighter-rouge">git status</code> بگیرین. دو خط اول رو برای مرج میبینید؟<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commit 7777777777777777777777777777777777777777
Merge: 5555555 6666666
Author: Nima &lt;billakh@spammer.bot&gt;
Date:   Thu Nov 3 10:11:27 2071 +0100

    Merge branch 'feature' into master.


      +--3--5--+
      |        |
1--2--+        +--7
      |        |
      +--4--6--+

</code></pre></div></div><p>خب یک مرج انجام شده و اگه شما <code class="highlighter-rouge">git log</code> روی برنچ <code class="highlighter-rouge">master</code> بگیرین، یک خروجی خطی به این ترتیب میگیرین: <code class="highlighter-rouge">7 6 5 4 3 2 1</code> به ترتیب تاریخ. البته باید گفت که این فقط ظاهر قضیه است. زیر کار(!) تاریخچه این کامیتها خطی نیست. یعنی اگه شما به کامیت 5 چک آوت کنید و لاگ بگیرید هیستوری ای که میگیرید به این ترتیب هست : <code class="highlighter-rouge">5 3 2 1</code> کامیت 4 یک child از 5 یا parent کامیت 3 نیست. پس تو خروجی نمیبینیمش. <code class="highlighter-rouge">fast-forward merge</code> تنها حالتی که مرج کردن باعث ساختن کامیت جدید نمیشه، مرج <code class="highlighter-rouge">fast-forward</code> هست. وقتی این حالت اتفاق میفته که کامیت دیگه ای تو برنچ‌های دیگه وجود نداشته باشه.<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Before

1--2--+         master
      |
      +--3--4   feature

After

1--2--3--4   master/feature
</code></pre></div></div><h2 id="git-rebase">git rebase</h2><p>ریبیس ایجاد مجدد کاریه که شما رو یه برنچ انجام دادید رو برنچی که میخواید باشن. یعنی به ازای کامیت هایی از شما که در برنچ <code class="highlighter-rouge">feature</code> که تو <code class="highlighter-rouge">master</code> وجود ندارن کامیت جدید بالای کار ایجاد میشه. یک بار دیگه به آرومی بخونین: <strong>کامیت جدید به ازای هر کامیت قدیمی با همون تغییرات.</strong> وقتی شما به برنچ <code class="highlighter-rouge">feature</code> چک اوت کنین و به مستر ریبیس کنین این چیزیه که اتفاق میفته<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      +--3--5   master
      |
1--2--+
      |
      +--3--5--7--8   feature
              (4)(6)
</code></pre></div></div><p>ریبیس کامیت های ۴ و ۶ رو پاک میکنه، با گرفتن تغییرات ۳ و ۵ با <code class="highlighter-rouge">master</code> سینک میشه و (اون جمله که آروم خوندین رو یادتون بیاد) کامیت جدید به ازای هر کامیت قدیمی با همون تغییرات ایجاد میشه. تو مثال بالا کامیت ۷ با همون تغییرات کامیت ۴ و کامیت ۸ با همون تغییرات کامیت ۶ اضافه میشن. بدین ترتیب برنچ <code class="highlighter-rouge">feature</code> همه تغییرات <code class="highlighter-rouge">master</code> رو داره به علاوه تغییرات خودش. حالا بعد از یک <code class="highlighter-rouge">fast-forward merge</code> بی دردسر شما همچین چیزی خواهید داشت:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1--2--3--5--7--8   master/feature
</code></pre></div></div><p>حالا <code class="highlighter-rouge">git log</code> به شما این خروجی رو میده : <code class="highlighter-rouge">8 7 5 3 2 1</code> با این تفاوت که تاریخچه کامیت ها هم به همین ترتیب خطیه و با چک اوت کردن به عقب چیزی که نباید گم شه گم نمیشه.<p>درنهایت کجا merge کنیم کجا rebase ؟ همونطوری که میشه حدس زد و ابتدای مقاله اشاره شد به ورک فلو توافقی تیم بستگی داره. اما به این نکته ها رو توجه کنید:<h3 id="ریبیس-کنید-وقتی">ریبیس کنید وقتی:</h3><ul><li>میخواید تغییرات لوکال خودتون رو مرج کنید و نیازی به تاریخچه دقیق ندارید پس چرا باید با کامیت های اضافه merge کثیفش کنید؟<li>هیستوری خطی براتون مهمه و از <code class="highlighter-rouge">git bisect</code> زیاد استفاده میکنین<li>دارین رو یه فیچری کار میکنین که خیلی طول کشیده و تیمتون تو برنچ های دیگه کیلومترها ازتون جلوترن و کار شما بعد مرج چون کامیت های قدیمی تری هستن ممکنه بالای هیستوری نباشن و شما یا هم تیمی هاتون وقتی <code class="highlighter-rouge">pull</code> میکنن گمشون کنین. در صورتی که حالت معقولش برای همه اینه که چون تغییرات جدیدی هستن باید بالاتر باشن که کسی سورپرایز نشه.</ul><h3 id="مرج-کنید-وقتی">مرج کنید وقتی:</h3><ul><li>شما یه قسمت از تغییراتتون رو با بقیه به اشتراک گذاشتید و مهمه که ریپو های اون ها رو نترکونید. ریبیس کلی از هیستوری رو تغییر میده و مرج ساده امن تر و واسه بقیه قابل فهم تره.<li>شما واقعا به تاریخچه دقیق اهمیت میدین و میخواین که هیستوری مرج ها و کامیت ها دقیقا به همون ترتیب و جزئیات وجود داشته باشه.</ul><p>پس چرا مردم از ریبیس کردن میترسن؟ بر اساس تجربه شخصی و مشاهده کامیونیتی، نگرانی توسعه دهنده ها نسبت به ریبیس کردن از اینجا ها ناشی میشه:<p>به خاطر مکانیزم <code class="highlighter-rouge">git rebase</code> عموما کانفلیکت های بیشتر و سخت الرفع (!)تری تجربه میشه تجربه قبلی از دست دادن کار به خاطر بی دقتی تو interactive rebase ویا force push<h2 id="چه-کنیم-نترسیم--نصایح-الربایس">چه کنیم نترسیم ؟ (نصایح الربایس)</h2><ul><li>زود به زود کامیت و ریبیس کنین تا برنچتون خیلی عقب نیفته<li><p>اگه وسطش به کانفلیکت خوردین فیکس کنین و <code class="highlighter-rouge">git rebase --continue</code> کنین ریبیس بدون تغییر مسیر ادامه پیدا میکنه. البته اینجا مرج کامیت به وجود میاد که چیز لازمیه چون حل کردن کانفلیکت جزو تاریخچه است<li><p>اگه کانفلیکت انقدر فجیعه که از ریبیس کردن پشیمون شدین میتونین <code class="highlighter-rouge">git rebase --abort</code><br /> کنین و شما رو برگردونه اول جایی که ریبیس کردین<li><p>پول کردن با ریبیس هم ممکنه <code class="highlighter-rouge">git pull --rebase</code><li><p>با ریبیس کردن شما میتونین کامیت هارو پاک کنین. چندتا کامیت رو یکی کنین و مسیج های کامیت ها رو تغییر بدین این کار بهتون قدرت تغییر گذشته رو میده و یادتون نره هر تغییری در گذشته ممکنه باعث ایجاد پارادوکس بشه. هیچ وقت پدربزرگتون رو قبل از بدنیا اومدن پدرتون نکشین!<li><p>با تاریخچه بقیه هم ور نرین<li><table><tbody><tr><td>اگه فورس پوش میکنین هرگز هیچوقت فورس پوش تو ریموتی که بقیه دارن روش کار میکنن نکنین مگه اینکه اولا دقیقا بدونین دارین چیکار میکنین و دوما از تک تکشون رضایت نامه کتبی گرفته باشید :</table></ul><p>در نهایت همونطور که اول مقاله اشاره کردم معمولا ریبیس تو فلوی کاری من جایی نداشته و حتی سعی میکنم ازش استفاده نکنم ولی اونقدر خودم رو صاحب نظر نمیدونم که برای کسی تصمیم بگیرم</div><div class="post__share text--center"><ul class="list--unstyled list--inline"><li><a class="button button--with-icon" target="_blank" href="https://twitter.com/intent/tweet?url=/%DA%AF%DB%8C%D8%AA-rebase-%D8%A8%D9%87-%D8%B2%D8%A8%D8%A7%D9%86-%D8%B3%D8%A7%D8%AF%D9%87/&via=http://pullrequest.ir&text=گیت Rebase به زبان ساده"> <i class="icon pricon-twitter"></i> توییتر </a><li><a class="button button--with-icon" target="_blank" href="https://telegram.me/share/url?url=http://pullrequest.ir/%DA%AF%DB%8C%D8%AA-rebase-%D8%A8%D9%87-%D8%B2%D8%A8%D8%A7%D9%86-%D8%B3%D8%A7%D8%AF%D9%87/"> <i class="icon pricon-telegram"></i> تلگرام </a></ul></div><script> window.pr.methods.docReady(function() { var singleEntry = window.pr.methods.selectElementByClassName('.post__entry--single'); var excerptEntry = window.pr.methods.selectElementByClassName('.post__excerpt'); if (singleEntry) window.pr.methods.parseTextForEmojis(singleEntry); else if (excerptEntry) window.pr.methods.parseTextForEmojis(excerptEntry); }) </script><hr /><div class="comments"><div id="disqus_thread"></div><script async defer src='https://pwl-rykhwyst.disqus.com/embed.js' onerror="disqusHandler();"></script> <script type="text/javascript"> var disqusHandler = (function (w) { var methods = w.pr.methods; /* methods.docReady(function () { loadDisqusScript() }); function loadDisqusScript() { methods.getAjax('https://pwl-rykhwyst.disqus.com/embed.js', null, function (e) { addDisqusErrorIfNotPresent(); // Parse any emoji inside error methods.parseTextForEmojis(document.getElementById('comment__error')); }) } */ function addDisqusErrorIfNotPresent() { var comments = methods.selectElementByClassName('.comments'); /* Add only for the 1st time */ if (!methods.selectElementById('comment__error')) { /* Add error to .comments */ comments.appendChild(createDisqusError()); /* Parse any emoji inside error */ methods.parseTextForEmojis(document.getElementById('comment__error')); } } function createDisqusError() { var err = document.createElement('div'); err.id = 'comment__error'; window.pr.methods.addClass('alert', err); err.innerHTML = 'اگر این پیام رو میبینین، به این معنیه که اسکریپت Disqus براتون لود نشده. سرویس Disqus توی ایران فیلتر شده!! <strong>لطفا وی پی ان تون رو روشن کنین و صفحه فعلی رو ریفرش کنین.</strong> :پی'; return err; } return addDisqusErrorIfNotPresent; })(window); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></article></div><footer class="site__footer clearfix"><div class="site__footer__brand" onclick="window.pr.methods.goToTop()"> <img class="img-block" src="/assets/images/pr.svg" alt="PR"></div><div class="container clearfix"><nav class="pull-right site__footer__menu"><ul class="list--unstyled list--inline site__footer__list"><li> <a target="_blank" href="https://github.com/pr-techblog"> <i class="icon pricon-github"></i> گیتهاب </a><li> <a target="_blank" href="https://twitter.com/pr_techblog"> <i class="icon pricon-twitter"></i> توییتر </a></ul></nav><div class="pull-left text--ltr site__footer__copyright">Made with ❦ @ <strong>PullRequest</strong></div></div></footer></div><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93910742-1', 'auto'); ga('send', 'pageview', { 'page': '/%DA%AF%DB%8C%D8%AA-rebase-%D8%A8%D9%87-%D8%B2%D8%A8%D8%A7%D9%86-%D8%B3%D8%A7%D8%AF%D9%87/', 'title': 'گیت Rebase به زبان ساده' }); </script>
