<!DOCTYPE html><html><head><title>ساخت ابزار cli با nodejs</title><meta charset="utf-8" /><meta content='text/html; charset=utf-8' http-equiv='Content-Type'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'><meta property="og:locale" content="fa_IR" /><meta property="og:site_name" content="پول ریکوئست" /><meta name="twitter:image" content="/assets/images/pr.svg" /><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="theme-color" content="#000"><meta property="og:type" content="article" /><meta name="description" content="ترمینال خیلی جای خوبیه. البته منظورم ترمینال جنوب نیست، منظورم از ترمینال، کنسول یا پاورشل یا کامندلاین یا cmd یا بنا بر گفته بسیاری از مهندسان حال حاضر دنیا، همون داس هستش. من هم توی این پست میخوام ساخت یه ابزار واسه اون رو یاد بدم. جوری که دیگه به جای باز کردن مای‌کامپیوتر و…، با تایپ اسم ابزار خودمون و پاس دادن آرگومنت‌هامون بهش، عملیات مورد نظرمون انجام بشه. اونم با جاواسکریپت و نود‌جی‌اس. لایک عه باس. " /><meta property="og:description" content="ترمینال خیلی جای خوبیه. البته منظورم ترمینال جنوب نیست، منظورم از ترمینال، کنسول یا پاورشل یا کامندلاین یا cmd یا بنا بر گفته بسیاری از مهندسان حال حاضر دنیا، همون داس هستش. من هم توی این پست میخوام ساخت یه ابزار واسه اون رو یاد بدم. جوری که دیگه به جای باز کردن مای‌کامپیوتر و…، با تایپ اسم ابزار خودمون و پاس دادن آرگومنت‌هامون بهش، عملیات مورد نظرمون انجام بشه. اونم با جاواسکریپت و نود‌جی‌اس. لایک عه باس. " /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="ترمینال خیلی جای خوبیه. البته منظورم ترمینال جنوب نیست، منظورم از ترمینال، کنسول یا پاورشل یا کامندلاین یا cmd یا بنا بر گفته بسیاری از مهندسان حال حاضر دنیا، همون داس هستش. من هم توی این پست میخوام ساخت یه ابزار واسه اون رو یاد بدم. جوری که دیگه به جای باز کردن مای‌کامپیوتر و…، با تایپ اسم ابزار خودمون و پاس دادن آرگومنت‌هامون بهش، عملیات مورد نظرمون انجام بشه. اونم با جاواسکریپت و نود‌جی‌اس. لایک عه باس. " /><meta name="author" content="پول ریکوئست به قلم amir" /><meta property="og:title" content="ساخت ابزار cli با nodejs" /><meta property="twitter:title" content="ساخت ابزار cli با nodejs" /><link rel="stylesheet" type="text/css" href="/style.css" /><link rel="alternate" type="application/rss+xml" title="پول ریکوئست - پول ریکوئست، دست نوشته های فنی فارسی زبان" href="/feed.xml" /> <script src="/pr.js"></script><body><div class="site__container"><header class="site__header container"><figure class="site__header__brand"> <a href="http://pullrequest.ir"> <img src="/assets/images/pr.svg" alt="PR"> </a></figure><nav class="site__header__nav"><ul class="list--unstyled list--inline header__list text--center"><li> <a href="/about">پول ریکوئست چیست</a><li> <a href="/pr-authors">نویسندگان</a><li> <a href="/contribute">راهنمای انتشار مطالب در پول ریکوئست</a></ul></nav></header><hr class="site__header__divider container" /><main role="main" class="container"><article class="post post--single"><h1 class="post__title post__title--single">ساخت ابزار cli با nodejs</h1><div class="post__info"> <span> <span class="lazyimage"> <img onload="window.pr.methods.addClass('img-loaded', this.parentNode)" onerror="window.pr.methods.addClass('img-error', this)" src="/assets/images/amir.png" alt="امیر مومنیان" class="img-rounded post__info__figure inline--middle" > </span> <span class="inline--middle post__author"><a href="http://pullrequest.ir/authors/amir">امیر مومنیان</a></span> </span> <small><em>1396-2-12</em></small></div><div class="post__share text--left"><ul class="list--unstyled list--inline"><li><a class="button button--with-icon" target="_blank" href="https://twitter.com/intent/tweet?url=/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-cli-%D8%A8%D9%87-%DA%A9%D9%85%DA%A9-nodejs/&via=http://pullrequest.ir&text=ساخت ابزار cli با nodejs"> <i class="icon pricon-twitter"></i> توییتر </a><li><a class="button button--with-icon" target="_blank" href="https://telegram.me/share/url?url=http://pullrequest.ir/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-cli-%D8%A8%D9%87-%DA%A9%D9%85%DA%A9-nodejs/"> <i class="icon pricon-telegram"></i> تلگرام </a></ul><nav class="post__tags post__tags--single"> <i class="icon pricon-tag"></i><ul class="list--unstyled list--inline"><li><a href="/tag/javascript">#javascript</a><li><a href="/tag/nodejs">#nodejs</a><li><a href="/tag/cli">#cli</a></ul></nav></div><div class="post__entry post__entry--single"><p>ترمینال خیلی جای خوبیه. البته منظورم ترمینال جنوب نیست، منظورم از ترمینال، کنسول یا پاورشل یا کامندلاین یا cmd یا بنا بر گفته بسیاری از مهندسان حال حاضر دنیا، همون داس هستش. من هم توی این پست میخوام ساخت یه ابزار واسه اون رو یاد بدم. جوری که دیگه به جای باز کردن مای‌کامپیوتر و…، با تایپ اسم ابزار خودمون و پاس دادن آرگومنت‌هامون بهش، عملیات مورد نظرمون انجام بشه. اونم با جاواسکریپت و نود‌جی‌اس. لایک عه باس.<h1 id="شروع-به-نوشتن">شروع به نوشتن</h1><p>پروژه‌مون رو مثل یه برنامه عادی با نوشتن کامندهای زیر شروع می‌کنیم:<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>my-project
<span class="nb">cd </span>my-project
</code></pre></div></div><p>حالا یه فایل می‌سازیم به اسم package.json و محتویات زیر رو داخلش قرار می‌دیم.<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-project"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"bin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"my-project"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index.js"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div><p>البته ما با <code class="highlighter-rouge">npm init</code> هم می‌تونستیم این فایل رو بسازیم، اما ظاهرا این کامند نمی‌تونه keyهای خاص ما رو قبول کنه. یکی از این keyها، <strong>bin</strong> هستش که توش میگیم وقتی کاربر توی ترمینالش تایپ کرد <strong>my-project</strong>، اسکریپت ما اجرا بشه.<p>حالا توی فولدر فوق، فایل <strong>index.js</strong> که درواقع اسکریپت اصلی برنامه خودمون هست رو ایجاد میکنیم و توش محتویات زیر رو مینویسیم:<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#!/usr/bin/env node
</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"salam"</span><span class="p">);</span>
</code></pre></div></div><p>این یه برنامه سادست که به محض اجرا، عبارت <strong>salam</strong> رو نمایش می‌ده. فقط حواستون باشه که خط اول این اسکریپت خیلی مهمه. این خط به سیستم‌عامل می‌فهمونه که از <code class="highlighter-rouge">node</code> برای اجرای دستورات بعدی این فایل استفاده کنه. چون همون‌طور که می‌دونید این اسکریپت مستقیم توسط سیستم‌عامل قراره اجرا بشه و ما قرار نیست همیشه با <code class="highlighter-rouge">node index.js</code> اون رو اجرا کنیم. برای شروع، دونستن همین کافیه. ولی اگر گیک درونتون بی‌تابی می‌کنه، می‌تونید از <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">اینجا</a> بیشتر بخونید راجع بهش.<p>خب حالا برای تست، توی ترمینال می‌نویسیم:<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node index.js
</code></pre></div></div><p>و ترمینال هم برای پاسخ به زحمات ما، به ما سلام می‌کنه!<p>اما این خیلی ساده بود. مطمئنم تا اینجاش رو خودتون می‌دونستید. اما الان قراره چیزهای مهم‌تری رو بگم. مثل آرگومنت‌ها که به این برنامه قراره پاس داده بشن. کامند <code class="highlighter-rouge">cd</code> رو در نظر بگیرید. ما توی ترمینال همیشه در ادامه تایپ این کامند، آدرس دایرکتوری مورد نظرمون رو می‌نویسیم. مثلا <code class="highlighter-rouge">cd ./felan</code>. این آدرس، یه آرگومنت هستش که به این برنامه پاس داده می‌شه. حالا ما هم می‌خوایم به برناممون آرگومنت پاس بدیم. پس دوباره فایل <strong>index.js</strong> رو باز کنید و این تغییرات رو روش اعمال کنید.<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#!/usr/bin/env node
</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"salam "</span> <span class="o">+</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">);</span>
</code></pre></div></div><p>حالا توی ترمینال، به جای دستور قبلی می‌نویسیم:<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node index.js amir
</code></pre></div></div><p>و این بار ترمینال اون آرگومان ما رو هم چاپ می‌کنه! اما یه سوال، اون <code class="highlighter-rouge">process.argv</code> چی بود؟ الان می‌گم. آبجکت <code class="highlighter-rouge">process</code> توی برنامه‌های <code class="highlighter-rouge">node</code> ما در دسترسه. توی این آبجکت اطلاعاتی مثل <code class="highlighter-rouge">دایرکتوری کنونی</code> و <code class="highlighter-rouge">آدرس فولدر کاربر</code> و <code class="highlighter-rouge">آرگومنت‌های تایپ‌شده</code> و متودهایی مثل <code class="highlighter-rouge">بستن برنامه</code> و ایونت‌هایی مثل <code class="highlighter-rouge">قبل از بسته‌شدن</code> و اینها قرارداره. چیزی که ما ازش استخراج کردیم، <code class="highlighter-rouge">argv</code> یا همون <code class="highlighter-rouge">آرگومنت‌های تایپ‌شده</code>هست که در واقع یه لیست از آرگومنت‌های تایپ‌شده کاربر توی ترمیناله. توی این لیست همیشه خانه 0 برابر با خود اسکریپت <code class="highlighter-rouge">node</code> و خانه 1 برابر با اسکریپت ما یا همون <strong>index.js</strong> هست. پس از خانه 2 به بعد، تمام آیتم‌ها همون آرگومنت‌هایی هستن که به برنامه ما پاس داده شدن. همینطور که توی مثال دیدید.<h1 id="پس-چرا-هنوز-کامند-my-project-فعال-نشده">پس چرا هنوز کامند my-project فعال نشده؟</h1><p>بخاطر اینکه این پروژه هنوز هیچ‌جا نصب نیست. یادتون نره که این یک پروژه <code class="highlighter-rouge">node</code> هستش و ما نیازی نداریم جایی <code class="highlighter-rouge">environment</code> ست کنیم، فقط باید این پکیج رو به صورت گلوبال روی سیستم نصب کنیم. پس با اجرای کامند زیر توی ترمینال، این کار رو می‌کنیم و بعدش وقتی توی ترمینال نوشتیم <strong>my-project salam</strong> دیگه سیستم‌عامل به ما خطای <code class="highlighter-rouge">command not found</code> نمی‌ده، چون <code class="highlighter-rouge">node</code> می‌پره وسط و به سیستم‌عامل می‌گه که منظور کاربر از این کامند در واقع همون برنامه ماست (دوغ):<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">-g</span>
</code></pre></div></div><p>البته ما قرار نیست همینجا متوقف بشیم و با نوشتن برنامه سلام کردن به کاربر از دنیای برنامه‌نویسی خداحافظی کنیم، ما قراره برنامه‌های خفن‌تری بنویسیم. این دوتا لینک هم قراره مطالعه کنیم، چون توضیح کاملشون توی این پست نمی‌گنجید. :D<ul><li><a href="https://nodejs.org/docs/latest/api/process.html">راهنمای آبجکت process</a><li><a href="https://www.npmjs.com/package/commander">پکیج commander برای مدیریت آرگومان‌ها</a></ul><h2 id="حرف-آخر">حرف آخر</h2><p>امیدوارم از این آموزش خوشتون اومده باشه و مورد استفادتون قرار بگیره و یا حداقل انگیزه‌ای شده باشه برای شروع نوشتن برنامه‌های جالبی که توی ذهنتون دارید. اگر هم نظری یا انتقادی در مورد این پست دارید، درهای کامنت و PR همیشه به روی شما باز است.</div><div class="post__share text--center"><ul class="list--unstyled list--inline"><li><a class="button button--with-icon" target="_blank" href="https://twitter.com/intent/tweet?url=/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-cli-%D8%A8%D9%87-%DA%A9%D9%85%DA%A9-nodejs/&via=http://pullrequest.ir&text=ساخت ابزار cli با nodejs"> <i class="icon pricon-twitter"></i> توییتر </a><li><a class="button button--with-icon" target="_blank" href="https://telegram.me/share/url?url=http://pullrequest.ir/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-cli-%D8%A8%D9%87-%DA%A9%D9%85%DA%A9-nodejs/"> <i class="icon pricon-telegram"></i> تلگرام </a></ul></div><script> window.pr.methods.docReady(function() { var singleEntry = window.pr.methods.selectElementByClassName('.post__entry--single'); var excerptEntry = window.pr.methods.selectElementByClassName('.post__excerpt'); if (singleEntry) window.pr.methods.parseTextForEmojis(singleEntry); else if (excerptEntry) window.pr.methods.parseTextForEmojis(excerptEntry); }) </script><hr /><div class="comments"><div id="disqus_thread"></div><script async defer src='https://pwl-rykhwyst.disqus.com/embed.js' onerror="disqusHandler();"></script> <script type="text/javascript"> var disqusHandler = (function (w) { var methods = w.pr.methods; /* methods.docReady(function () { loadDisqusScript() }); function loadDisqusScript() { methods.getAjax('https://pwl-rykhwyst.disqus.com/embed.js', null, function (e) { addDisqusErrorIfNotPresent(); // Parse any emoji inside error methods.parseTextForEmojis(document.getElementById('comment__error')); }) } */ function addDisqusErrorIfNotPresent() { var comments = methods.selectElementByClassName('.comments'); /* Add only for the 1st time */ if (!methods.selectElementById('comment__error')) { /* Add error to .comments */ comments.appendChild(createDisqusError()); /* Parse any emoji inside error */ methods.parseTextForEmojis(document.getElementById('comment__error')); } } function createDisqusError() { var err = document.createElement('div'); err.id = 'comment__error'; window.pr.methods.addClass('alert', err); err.innerHTML = 'اگر این پیام رو میبینین، به این معنیه که اسکریپت Disqus براتون لود نشده. سرویس Disqus توی ایران فیلتر شده!! <strong>لطفا وی پی ان تون رو روشن کنین و صفحه فعلی رو ریفرش کنین.</strong> :پی'; return err; } return addDisqusErrorIfNotPresent; })(window); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></article></div><footer class="site__footer clearfix"><div class="site__footer__brand" onclick="window.pr.methods.goToTop()"> <img class="img-block" src="/assets/images/pr.svg" alt="PR"></div><div class="container clearfix"><nav class="pull-right site__footer__menu"><ul class="list--unstyled list--inline site__footer__list"><li> <a target="_blank" href="https://github.com/pr-techblog"> <i class="icon pricon-github"></i> گیتهاب </a><li> <a target="_blank" href="https://twitter.com/pr_techblog"> <i class="icon pricon-twitter"></i> توییتر </a></ul></nav><div class="pull-left text--ltr site__footer__copyright">Made with ❦ @ <strong>PullRequest</strong></div></div></footer></div><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93910742-1', 'auto'); ga('send', 'pageview', { 'page': '/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-cli-%D8%A8%D9%87-%DA%A9%D9%85%DA%A9-nodejs/', 'title': 'ساخت ابزار cli با nodejs' }); </script>
